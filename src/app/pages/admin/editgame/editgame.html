<app-admin-navbar></app-admin-navbar>

<div class="page-container">
    <div *ngIf="isLoading" class="loading-spinner">Loading game data...</div>
    <div *ngIf="errorMessage" class="error-message">{{ errorMessage }}</div>

    <div *ngIf="!isLoading && !errorMessage && currentGame" class="form-container">
        <h2>Edit Game: {{ currentGame.game_name }}</h2>

        <form #editForm="ngForm" (ngSubmit)="onUpdateGame()">
            <div class="form-content">
                <div class="column">
                    <div class="form-group">
                        <label for="gameName">Game Title</label>
                        <input type="text" id="gameName" name="game_name" [(ngModel)]="currentGame.game_name" required>
                    </div>
                    <div class="form-group">
                        <label for="gameType">Game Type</label>
                        <select id="gameType" name="type_id" [(ngModel)]="currentGame.type_id" required>
                            <option [ngValue]="null" disabled>-- Select a type --</option>
                            <option *ngFor="let type of gameTypes" [value]="type.type_id">
                                {{ type.type_name }}
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="gamePrice">Price (à¸¿)</label>
                        <input type="number" id="gamePrice" name="price" [(ngModel)]="currentGame.price" required
                            min="0">
                    </div>
                </div>

                <div class="column">
                    <div class="form-group">
                        <label>Game Image</label>

                        <input type="file" id="imageUpload" (change)="onFileSelected($event)" accept="image/*"
                            style="display: none;">

                        <label for="imageUpload" class="image-upload-area">

                            <div *ngIf="newImagePreviewUrl" class="image-preview-wrapper">
                                <img [src]="newImagePreviewUrl" alt="New image preview" class="image-display">
                                <span class="overlay-text">Click to Change Image</span>
                            </div>

                            <div *ngIf="!newImagePreviewUrl && originalImageUrl" class="image-preview-wrapper">
                                <img [src]="originalImageUrl" alt="Current image" class="image-display">
                                <span class="overlay-text">Click to Change Image</span>
                            </div>

                            <div *ngIf="!newImagePreviewUrl && !originalImageUrl"
                                class="image-preview-wrapper no-image">
                                <span class="no-image-text">Click to Upload</span>
                            </div>
                        </label>
                    </div>

                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" name="description" [(ngModel)]="currentGame.description"
                            rows="5"></textarea>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button type="button" class="btn btn-cancel" (click)="onCancel()">Cancel</button>
                <button type="submit" class="btn btn-save" [disabled]="!editForm.form.valid">Save Changes</button>
            </div>
        </form>
    </div>
</div>